<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Network File System: src/naming_server/nm_to_client.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Network File System
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('nm__to__client_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">nm_to_client.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Communication between the naming server and clients.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;../common/headers.h&quot;</code><br />
<code>#include &quot;headers.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5dde0e64eb5cf9f811b1a6e88e1fc952" id="r_a5dde0e64eb5cf9f811b1a6e88e1fc952"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nm__to__client_8c.html#a5dde0e64eb5cf9f811b1a6e88e1fc952">send_client_port</a> (const i32 clientfd, const enum operation op)</td></tr>
<tr class="memdesc:a5dde0e64eb5cf9f811b1a6e88e1fc952"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive path from client and send the corresponding storage server's port.  <br /></td></tr>
<tr class="separator:a5dde0e64eb5cf9f811b1a6e88e1fc952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ea7ac064d36b582ffb0ff0a8d77fab" id="r_ab0ea7ac064d36b582ffb0ff0a8d77fab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nm__to__client_8c.html#ab0ea7ac064d36b582ffb0ff0a8d77fab">create_operations</a> (const i32 clientfd, const enum operation op)</td></tr>
<tr class="memdesc:ab0ea7ac064d36b582ffb0ff0a8d77fab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive path from client, perform create operation on storage server and send the status code.  <br /></td></tr>
<tr class="separator:ab0ea7ac064d36b582ffb0ff0a8d77fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7de4d85c596e67cbb430624921edbba2" id="r_a7de4d85c596e67cbb430624921edbba2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nm__to__client_8c.html#a7de4d85c596e67cbb430624921edbba2">delete_operations</a> (const i32 clientfd, const enum operation op)</td></tr>
<tr class="memdesc:a7de4d85c596e67cbb430624921edbba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">receive path from client, perform delete operation on storage server and send the status code  <br /></td></tr>
<tr class="separator:a7de4d85c596e67cbb430624921edbba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab2088d4bdf9e891d760683885e7d3" id="r_afeab2088d4bdf9e891d760683885e7d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nm__to__client_8c.html#afeab2088d4bdf9e891d760683885e7d3">copy_file_or_folder</a> (<a class="el" href="structTreeNode.html">Tree</a> CopyTree, const char *from_path, const char *dest_path, const i32 from_sockfd, const i32 to_sockfd, const i32 to_port, char *UUID)</td></tr>
<tr class="memdesc:afeab2088d4bdf9e891d760683885e7d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a file or folder across different storage servers or same storage servers.  <br /></td></tr>
<tr class="separator:afeab2088d4bdf9e891d760683885e7d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa26a9f48cd86c8f44ee0463928270fde" id="r_aa26a9f48cd86c8f44ee0463928270fde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nm__to__client_8c.html#aa26a9f48cd86c8f44ee0463928270fde">copy_operation</a> (const i32 clientfd, const enum operation op)</td></tr>
<tr class="memdesc:aa26a9f48cd86c8f44ee0463928270fde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive 2 paths from client, perform copy operation on storage server and send the status code.  <br /></td></tr>
<tr class="separator:aa26a9f48cd86c8f44ee0463928270fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d67638712030ce0cbe360c1a85217d" id="r_a22d67638712030ce0cbe360c1a85217d"><td class="memItemLeft" align="right" valign="top"><a id="a22d67638712030ce0cbe360c1a85217d" name="a22d67638712030ce0cbe360c1a85217d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>send_tree_for_printing</b> (const i32 clientfd)</td></tr>
<tr class="separator:a22d67638712030ce0cbe360c1a85217d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019701a41a93cf6168617a8d82ae3f90" id="r_a019701a41a93cf6168617a8d82ae3f90"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nm__to__client_8c.html#a019701a41a93cf6168617a8d82ae3f90">client_init</a> (void *arg)</td></tr>
<tr class="memdesc:a019701a41a93cf6168617a8d82ae3f90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes connection to the clients and spawns a new client relay for each of them.  <br /></td></tr>
<tr class="separator:a019701a41a93cf6168617a8d82ae3f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8013e51b64d4bb64ce25cf288d82f31" id="r_ad8013e51b64d4bb64ce25cf288d82f31"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nm__to__client_8c.html#ad8013e51b64d4bb64ce25cf288d82f31">client_relay</a> (void *arg)</td></tr>
<tr class="memdesc:ad8013e51b64d4bb64ce25cf288d82f31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives all operations from the client. In case of READ, WRITE and METADATA, sends the port number of the corresponding storage server to the client. In other cases, performs the operation and sends the status code to the client.  <br /></td></tr>
<tr class="separator:ad8013e51b64d4bb64ce25cf288d82f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Communication between the naming server and clients. </p>
<ul>
<li>Receives initial client connections and spawns a new thread for each client</li>
<li>Handles all operations sent to the naming server from the client</li>
<li>Forwards requests to the storage server whenever needed </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a019701a41a93cf6168617a8d82ae3f90" name="a019701a41a93cf6168617a8d82ae3f90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a019701a41a93cf6168617a8d82ae3f90">&#9670;&#160;</a></span>client_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * client_init </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes connection to the clients and spawns a new client relay for each of them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void* NULL </dd></dl>

</div>
</div>
<a id="ad8013e51b64d4bb64ce25cf288d82f31" name="ad8013e51b64d4bb64ce25cf288d82f31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8013e51b64d4bb64ce25cf288d82f31">&#9670;&#160;</a></span>client_relay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * client_relay </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives all operations from the client. In case of READ, WRITE and METADATA, sends the port number of the corresponding storage server to the client. In other cases, performs the operation and sends the status code to the client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>integer pointer to the client file descriptor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void* NULL </dd></dl>

</div>
</div>
<a id="afeab2088d4bdf9e891d760683885e7d3" name="afeab2088d4bdf9e891d760683885e7d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab2088d4bdf9e891d760683885e7d3">&#9670;&#160;</a></span>copy_file_or_folder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_file_or_folder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTreeNode.html">Tree</a>&#160;</td>
          <td class="paramname"><em>CopyTree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dest_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const i32&#160;</td>
          <td class="paramname"><em>from_sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const i32&#160;</td>
          <td class="paramname"><em>to_sockfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const i32&#160;</td>
          <td class="paramname"><em>to_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>UUID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy a file or folder across different storage servers or same storage servers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CopyTree</td><td>The tree being copied from </td></tr>
    <tr><td class="paramname">from_path</td><td>current file/folder path being copied </td></tr>
    <tr><td class="paramname">dest_path</td><td>destination path </td></tr>
    <tr><td class="paramname">from_sockfd</td><td>socket of the storage server being copied from </td></tr>
    <tr><td class="paramname">to_sockfd</td><td>socket of the storage server being copied to </td></tr>
    <tr><td class="paramname">to_port</td><td>nm port for the <code>to</code> storage server </td></tr>
    <tr><td class="paramname">UUID</td><td>unique identifier of the <code>to</code> storage server </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa26a9f48cd86c8f44ee0463928270fde" name="aa26a9f48cd86c8f44ee0463928270fde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa26a9f48cd86c8f44ee0463928270fde">&#9670;&#160;</a></span>copy_operation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_operation </td>
          <td>(</td>
          <td class="paramtype">const i32&#160;</td>
          <td class="paramname"><em>clientfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const enum operation&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive 2 paths from client, perform copy operation on storage server and send the status code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientfd</td><td>file descriptor of the client socket </td></tr>
    <tr><td class="paramname">op</td><td>specified operation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab0ea7ac064d36b582ffb0ff0a8d77fab" name="ab0ea7ac064d36b582ffb0ff0a8d77fab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ea7ac064d36b582ffb0ff0a8d77fab">&#9670;&#160;</a></span>create_operations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void create_operations </td>
          <td>(</td>
          <td class="paramtype">const i32&#160;</td>
          <td class="paramname"><em>clientfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const enum operation&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive path from client, perform create operation on storage server and send the status code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientfd</td><td>file descriptor of the client socket </td></tr>
    <tr><td class="paramname">op</td><td>specified operation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7de4d85c596e67cbb430624921edbba2" name="a7de4d85c596e67cbb430624921edbba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7de4d85c596e67cbb430624921edbba2">&#9670;&#160;</a></span>delete_operations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void delete_operations </td>
          <td>(</td>
          <td class="paramtype">const i32&#160;</td>
          <td class="paramname"><em>clientfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const enum operation&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>receive path from client, perform delete operation on storage server and send the status code </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientfd</td><td>file descriptor of the client socket </td></tr>
    <tr><td class="paramname">op</td><td>specified operation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5dde0e64eb5cf9f811b1a6e88e1fc952" name="a5dde0e64eb5cf9f811b1a6e88e1fc952"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dde0e64eb5cf9f811b1a6e88e1fc952">&#9670;&#160;</a></span>send_client_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_client_port </td>
          <td>(</td>
          <td class="paramtype">const i32&#160;</td>
          <td class="paramname"><em>clientfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const enum operation&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive path from client and send the corresponding storage server's port. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientfd</td><td>file descriptor of the client socket </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5bc52ad34068cfc24a34e748d04dbe68.html">naming_server</a></li><li class="navelem"><a class="el" href="nm__to__client_8c.html">nm_to_client.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
